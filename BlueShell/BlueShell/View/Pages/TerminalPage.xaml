<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="BlueShell.View.Pages.TerminalPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:BlueShell.Converters"
    xmlns:model="using:BlueShell.Model"
    mc:Ignorable="d">

    <Page.Resources>
        <converters:TextTrimmer x:Key="TextTrimmer"/>
    </Page.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="TerminalColumnDefinition" Width="2*"/>
            <ColumnDefinition x:Name="DisplayColumnDefinition" Width="3*"/>
        </Grid.ColumnDefinitions>
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <RichEditBox x:Name="Terminal"
                         Grid.Row="0"
                         AcceptsReturn="False"
                         FontFamily="Cascadia Code"
                         FontSize="18"
                         PreviewKeyDown="Terminal_PreviewKeyDown"
                         SelectionChanged="Terminal_SelectionChanged">
            </RichEditBox>

            <ScrollViewer x:Name="OutputScrollViewer"
                          Grid.Row="1"
                          VerticalScrollBarVisibility="Auto"
                          VerticalAnchorRatio="1.0">
                <ItemsRepeater x:Name="OutputRepeater">
                    <ItemsRepeater.Layout>
                        <StackLayout Spacing="0"/>
                    </ItemsRepeater.Layout>

                    <ItemsRepeater.ItemTemplate>
                        <DataTemplate x:DataType="model:OutputLine">
                            <TextBlock Text="{x:Bind Text, Mode = OneWay}"
                                       Foreground="{x:Bind SolidColorBrush}"
                                       FontFamily="Cascadia Code"
                                       FontSize="18"
                                       TextWrapping="Wrap"/>
                        </DataTemplate>
                    </ItemsRepeater.ItemTemplate>
                </ItemsRepeater>
            </ScrollViewer>
        </Grid>
        <Grid Grid.Column="1"
              x:Name="DataDisplayGrid">
            <Grid Grid.Row="0"
                      Height="115"
                      Margin="0, 0, 0, 0"
                      VerticalAlignment="Top"
                      BorderBrush="{StaticResource SystemAccentColor}"
                      BorderThickness="0, 0, 0, 0.5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <ScrollViewer Grid.Row="0" 
                              HorizontalScrollBarVisibility="Auto"
                              HorizontalScrollMode="Auto"
                              VerticalScrollBarVisibility="Auto"
                              VerticalScrollMode="Auto">
                    <Grid>
                        <RadioButton x:Name="RbFolders"
                                         VerticalAlignment="Top"
                                         HorizontalAlignment="Left"
                                         FontFamily="Cascadia Mono"
                                         FontSize="15"
                                         Margin="10, 8, 0, 15"
                                         Padding="7, 7, 0, 0">Folders</RadioButton>
                        <RadioButton x:Name="RbFiles"
                                         VerticalAlignment="Top"
                                         FontFamily="Cascadia Mono"
                                         FontSize="15"
                                         Margin="110, 8, 0, 0"
                                         Padding="7, 7, 0, 0">Files</RadioButton>
                        <RadioButton x:Name="RbAll"
                                         IsChecked="True"
                                         VerticalAlignment="Top"
                                         FontFamily="Cascadia Mono"
                                         FontSize="15"
                                         Margin="195, 8, 0, 0"
                                         Padding="7, 7, 0, 0">All</RadioButton>
                        <CheckBox x:Name="CurrentFolder"
                                     VerticalAlignment="Top"
                                     FontFamily="Cascadia Mono"
                                     FontSize="15"
                                     IsEnabled="False"
                                     Margin="260, 8, 0, 0"
                                     Padding="10, 7, 0, 0">This Folder</CheckBox>
                        <AutoSuggestBox x:Name="ExtensionSearch"
                                            Height="35"
                                            VerticalAlignment="Top"
                                            Margin="400, 7, 0, 0"
                                            Width="140"
                                            HorizontalAlignment="Left"
                                            PlaceholderText="Extension..."
                                            FontFamily="Cascadia Mono"
                                            FontSize="16"
                                            VerticalContentAlignment="Center"></AutoSuggestBox>
                    </Grid>
                </ScrollViewer>
                <Grid Grid.Row="1"
                          Margin="10, 35, 10, 0">
                    <TextBlock x:Name="SearchedFolder"
                                   FontFamily="Cascadia Mono"
                                   FontSize="16"
                                   Margin="0, -27, 0, 0"></TextBlock>
                    <ProgressBar x:Name="SearchProgressBar"
                                     Margin="0, 5, 0, 0"
                                     Minimum="0"
                                     Maximum="100"/>
                </Grid>
            </Grid>
            <ScrollViewer HorizontalScrollBarVisibility="Auto"
                          HorizontalScrollMode="Auto"
                          VerticalScrollBarVisibility="Auto"
                          VerticalScrollMode="Auto"
                          Margin="0, 115, 0, 0">
                <Grid Padding="0, 0, 0, 10">
                    <ListView x:Name="DataDisplay"
                                  Background="{ThemeResource LayerOnMicaBaseAltFillColorTransparentBrush}"
                                  Margin="0, 0, 0, 0"
                                  SelectionMode="Multiple">
                        <ListView.Resources>
                            <RadialGradientBrush x:Key="TextControlBackgroundFocused">
                                <GradientStop Color="{ThemeResource LayerOnMicaBaseAltFillColorTransparent}"></GradientStop>
                            </RadialGradientBrush>
                            <RadialGradientBrush x:Key="TextControlBackgroundPointerOver">
                                <GradientStop Color="{ThemeResource LayerOnMicaBaseAltFillColorTransparent}"></GradientStop>
                            </RadialGradientBrush>
                        </ListView.Resources>
                        <ListView.Header>
                            <model:DataDisplayHeader
                                NameHeader=""
                                TypeHeader=""
                                SizeHeader="" />
                        </ListView.Header>
                        <ListView.HeaderTemplate>
                            <DataTemplate x:DataType="model:DataDisplayHeader">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" 
                                               Text="{x:Bind NameHeader}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"                                      
                                               Margin="{x:Bind NameMargin}"/>
                                    <TextBlock Grid.Column="1" 
                                               Text="{x:Bind SizeHeader}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"
                                               Margin="{x:Bind SizeMargin}"/>
                                    <TextBlock Grid.Column="2" 
                                               Text="{x:Bind TypeHeader}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"
                                               Margin="{x:Bind TypeMargin}"/>
                                </Grid>
                            </DataTemplate>
                        </ListView.HeaderTemplate>
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="model:DataDisplayItem">
                                <Grid>
                                    <Image Source="{x:Bind ItemIcon}" 
                                           Width="{x:Bind ImageSize}"        
                                           Height="{x:Bind ImageSize}"
                                           HorizontalAlignment="Left"
                                           Margin="{x:Bind ImageMargin}"/>
                                    <TextBlock Text="{x:Bind ItemName, Converter={StaticResource TextTrimmer}, ConverterParameter = 60}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"
                                               Padding="{x:Bind TextPadding}"
                                               VerticalAlignment="Center"
                                               Margin="14, 0, 0, 0"/>
                                    <ProgressBar Value="{x:Bind TakenSpace}"
                                                 Width="260"
                                                 Minimum="0"
                                                 Maximum="{x:Bind TotalSize}"
                                                 Visibility="{x:Bind IsTakenSpaceVisible}"
                                                 Foreground="{x:Bind Color}"
                                                 Margin="{x:Bind ProgressMargin}"
                                                 HorizontalAlignment="Left"/>
                                    <TextBlock Text="{x:Bind ItemType}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"
                                               VerticalAlignment="Center"
                                               Padding="0, 0, 0, 0"
                                               Margin="{x:Bind ItemTypeMargin}"/>
                                    <TextBlock Text="{x:Bind ItemSize}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"
                                               VerticalAlignment="Center"
                                               Visibility="{x:Bind IsSizeVisible}"
                                               Padding="0, 0, 0, 0"
                                               Margin="542, 0, 0, 0"/>
                                    <TextBlock Text="{x:Bind ItemSizeType}"
                                               FontFamily="Cascadia Mono"
                                               FontSize="14"
                                               VerticalAlignment="Center"
                                               Padding="0, 0, 0, 0"
                                               Margin="640, 0, 0, 0"/>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Grid>
</Page>
